services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: queue-stats-backend
    env_file:
      - .env
    environment:
      DJANGO_DEBUG: "${DJANGO_DEBUG}"
      DJANGO_ALLOWED_HOSTS: "${DJANGO_ALLOWED_HOSTS}"
      DJANGO_TIME_ZONE: "${DJANGO_TIME_ZONE}"
      DB_ENGINE: "${DB_ENGINE}"
      DB_HOST: "${DB_HOST}"
      DB_PORT: "${DB_PORT}"
      DB_NAME: "${DB_NAME}"
      DB_USER: "${DB_USER}"
      DB_PASSWORD: "${DB_PASSWORD}"
      ASTERISK_MONITOR_PATH: "${ASTERISK_MONITOR_PATH}"
      ASTERISK_AJAM_URL: "${ASTERISK_AJAM_URL}"
      ASTERISK_AJAM_USERNAME: "${ASTERISK_AJAM_USERNAME}"
      ASTERISK_AJAM_SECRET: "${ASTERISK_AJAM_SECRET}"
      ASTERISK_AJAM_AUTHTYPE: "${ASTERISK_AJAM_AUTHTYPE}"
      ASTERISK_AMI_HOST: "${ASTERISK_AMI_HOST}"
      ASTERISK_AMI_PORT: "${ASTERISK_AMI_PORT}"
      ASTERISK_AMI_USER: "${ASTERISK_AMI_USER}"
      ASTERISK_AMI_PASSWORD: "${ASTERISK_AMI_PASSWORD}"
    ports:
      - "${APP_PORT}:8000"
    volumes:
      - ./backend:/app
      - "${ASTERISK_MONITOR_HOST_PATH:-/var/spool/asterisk/monitor}:${ASTERISK_MONITOR_PATH:-/var/spool/asterisk/monitor/}:ro"
